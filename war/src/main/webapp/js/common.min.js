/*
 * Copyright (c) 2009, 2010, 2011, 2012, B3log Team
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @fileoverview util and every page should be used.
 *
 * @author <a href="mailto:LLY219@gmail.com">Liyuan Li</a>
 * @author <a href="mailto:DL88250@gmail.com">Liang Ding</a>
 * @version 1.0.2.2, Jul 23, 2012
 *//**
 * @description Util
 * @static
 */var Util={error:function(){$("#tipMsg").text("Error: "+arguments[0]+" File: "+arguments[1]+"\nLine: "+arguments[2]+" please report this issue on https://github.com/b3log/b3log-solo/issues/new"),$("#loadMsg").text("")},killIE:function(){if($.browser.msie){if($.browser.version==="6.0"||$.browser.version==="7.0"){window.location=latkeConfig.servePath+"/kill-browser.html";return}if(window.external&&window.external.twGetRunPath){var e=external.twGetRunPath();if(e&&e.toLowerCase().indexOf("360se")>-1&&window.location.href.indexOf("admin-index")>-1){window.location=latkeConfig.servePath+"/kill-browser.html";return}}}},replaceEmString:function(e){var t=e.split("[em");if(t.length===1)return e;e=t[0];for(var n=1;n<t.length;n++){var r=t[n].substr(0,2);e+="<img src='"+latkeConfig.staticServePath+"/skins/"+Label.skinDirName+"/images/emotions/em"+r+".png' alt='"+Label["em"+r+"Label"]+"' title='"+Label["em"+r+"Label"]+"'/>"+t[n].substr(3)}return e},proessURL:function(e){return/^\w+:\/\//.test(e)||(e="http://"+e),e},switchMobile:function(e){Cookie.createCookie("btouch_switch_toggle",e,365),setTimeout(function(){location.reload()},1250)},setTopBar:function(){var e=$("#top");if(e.length===1){var t=$("#showTop");t.click(function(){e.slideDown(),t.hide()}),$("#hideTop").click(function(){e.slideUp(),t.show()})}},goTop:function(){var e=e||.1,t=$(window).scrollTop(),n=1+e;window.scrollTo(0,Math.floor(t/n));if(t>0){var r="Util.goTop("+e+")";window.setTimeout(r,16)}},goBottom:function(e){e||(e=0),window.scrollTo(0,$("body").height()-$(window).height()-e)},init:function(){Util.killIE(),Util.setTopBar()},clearCache:function(e){var t={};e==="all"?t={all:"all",URI:""}:t={all:"",URI:window.location.pathname},$.ajax({type:"POST",url:latkeConfig.servePath+"/clear-cache.do",cache:!1,contentType:"application/json",data:JSON.stringify(t),success:function(e){window.location.reload()}})},replaceSideEm:function(e){for(var t=0;t<e.length;t++){var n=$(e[t]);n.html(Util.replaceEmString(n.html()))}},buildTags:function(e){e=e||"tags";var t=["tags1","tags2","tags3","tags4","tags5"],n=$("#"+e+" b").get(),r=parseInt($("#"+e+" b").last().text()),i=Math.ceil(r/t.length);for(var s=0;s<n.length;s++){var o=parseInt(n[s].innerHTML);for(var u=0;u<t.length;u++)if(o>u*i&&o<=(u+1)*i){n[s].parentNode.className=t[u];break}}$("#"+e).html($("#"+e+" li").get().sort(function(e,t){var n=$(e).find("span").text().toLowerCase(),r=$(t).find("span").text().toLowerCase();return n.localeCompare(r)}))},toDate:function(e,t){var n=new Date(e),r,i=n.getFullYear(),s=n.getMonth()+1,o=n.getDate(),u=n.getHours()+1,a=n.getMinutes()+1;switch(t){case"yy-MM-dd HH:mm":r=i.toString().substr(2)+"-"+s+"-"+o+" "+u+":"+a;break;default:}return r}};if(!Cookie)var Cookie={readCookie:function(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return decodeURIComponent(i.substring(t.length,i.length))}return""},eraseCookie:function(e){this.createCookie(e,"",-1)},createCookie:function(e,t,n){var r="";if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3),r="; expires="+i.toGMTString()}document.cookie=e+"="+encodeURIComponent(t)+r+"; path=/"}};